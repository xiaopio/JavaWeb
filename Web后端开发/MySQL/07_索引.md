# 索引

## 介绍

**索引（index）** 就是帮助数据库**高效获取数据**的**数据结构**。

### 优点

#### 提高查询速度

- **原理**：数据库索引类似于书籍的目录，它通过预先对表中的一列或多列数据进行排序和存储相关信息，在执行查询操作时，数据库系统可以快速定位到符合条件的数据位置，而不需要对整个表进行全表扫描。

#### 加速表之间的连接操作

- **原理**：在关系数据库中，经常需要进行表的连接操作，通过索引可以快速定位到关联表中的匹配记录，从而提高连接操作的效率。

#### 减少分组和排序的时间

- **原理**：索引本身是按照一定顺序存储的数据结构，当执行分组（GROUP BY）或排序（ORDER BY）操作时，如果查询的列与索引列相同或者相关，数据库可以利用索引的顺序来直接获取已经排序好的数据，减少额外的排序操作时间。

### 缺点

#### 占用额外的存储空间

- **原理**：索引本身是一种数据结构，它需要占用一定的磁盘空间来存储索引数据。除了存储索引列的值之外，还可能需要存储一些其他信息，如指向原表数据的指针等。

#### 降低数据更新操作的效率

- **原理**：当对表中的数据进行插入（INSERT）、删除（DELETE）和更新（UPDATE）操作时，数据库不仅要更新表中的数据，还要同时更新相关的索引。因为索引是基于表数据构建的有序结构，数据的任何变化都可能导致索引的重新排序或部分更新，这增加了数据更新操作的时间和复杂性。

#### 可能导致索引失效

- **原理**：如果在查询中使用了不恰当的条件或者对索引列进行了不适当的操作，数据库可能无法有效地利用索引，导致索引失效。这可能会使查询性能下降，甚至比不使用索引还要慢，因为数据库可能会先尝试使用索引，发现无法使用后再进行全表扫描。

## 结构

MySQL数据库支持的索引结构有很多，如：Hash索引、B+Tree索引、Full-Text索引等。默认**B+Tree**。

**B+Tree（多路平衡搜索树）**

```
- 每一个节点，可以存储多个key

- 所有的数据都是存储在叶子节点，非叶子节点仅用于索引数据

- 叶子节点形成了一颗双向链表，便于数据的排序及区间范围查询
```

## 语法

#### **创建索引**

create [unique] index 索引名 on 表名 (字段名, ...) ;

#### **查看索引**

show index from 表名 ;

### **删除索引**

drop index 索引名 on 表名 ;

```sql
-- 创建索引
create index idx_emp_name on tb_emp (name);

-- 查询索引
show index from tb_emp;

-- 删除索引
drop index idx_emp_name on tb_emp;
```

> [!NOTE]
>
> - 主键字段，在建表时，会自动创建主键索引
> - 添加唯一约束时，数据库实际上会添加唯一索引

